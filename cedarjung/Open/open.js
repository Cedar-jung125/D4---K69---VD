const MN2ED_examData = {
  ielts: {
    name: "IELTS",
    skills: [
      {
        name: "Listening",
        icon: "fas fa-headphones",
        materials: [
          {
            title: "Cambridge IELTS Listening Tests",
            pdfs: [
              {
                name: "Cambridge IELTS 15 Listening",
                path: "pdf/ielts/listening/cambridge_15.pdf",
                size: "2.4MB",
                pages: 45,
              },
              {
                name: "Listening Practice Test Vol.3",
                path: "pdf/ielts/listening/practice_vol3.pdf",
                size: "1.8MB",
                pages: 32,
              },
              {
                name: "Academic Listening Strategies",
                path: "/pdf/ielts/listening/strategies.pdf",
                size: "3.1MB",
                pages: 58,
              },
            ],
          },
          {
            title: "Chiến thuật Listening band 8+",
            pdfs: [
              {
                name: "Listening Tips & Tricks",
                path: "/pdf/ielts/listening/tips.pdf",
                size: "1.5MB",
                pages: 28,
              },
              {
                name: "Common Listening Mistakes",
                path: "/pdf/ielts/listening/mistakes.pdf",
                size: "0.9MB",
                pages: 16,
              },
            ],
          },
          {
            title: "Từ vựng Listening theo chủ đề",
            pdfs: [
              {
                name: "Vocabulary for Section 1-2",
                path: "/pdf/ielts/listening/vocab_s1-2.pdf",
                size: "1.2MB",
                pages: 22,
              },
              {
                name: "Vocabulary for Section 3-4",
                path: "/pdf/ielts/listening/vocab_s3-4.pdf",
                size: "1.4MB",
                pages: 25,
              },
            ],
          },
        ],
      },
      {
        name: "Reading",
        icon: "fas fa-book-open",
        materials: [
          {
            title: "Bộ đề Reading Cambridge",
            pdfs: [
              {
                name: "Cambridge IELTS 16 Reading",
                path: "/pdf/ielts/reading/cambridge_16.pdf",
                size: "3.2MB",
                pages: 52,
              },
              {
                name: "Academic Reading Practice",
                path: "/pdf/ielts/reading/academic_practice.pdf",
                size: "2.8MB",
                pages: 48,
              },
            ],
          },
          {
            title: "Kỹ thuật đọc hiệu quả",
            pdfs: [
              {
                name: "Skimming & Scanning Guide",
                path: "/pdf/ielts/reading/skimming.pdf",
                size: "1.7MB",
                pages: 30,
              },
              {
                name: "Time Management for Reading",
                path: "/pdf/ielts/reading/time_management.pdf",
                size: "1.1MB",
                pages: 18,
              },
            ],
          },
        ],
      },
      {
        name: "Writing",
        icon: "fas fa-pen-fancy",
        materials: [
          {
            title: "Bài mẫu Writing Task 2 band 9",
            pdfs: [
              {
                name: "50 Model Essays",
                path: "/pdf/ielts/writing/model_essays.pdf",
                size: "4.5MB",
                pages: 85,
              },
              {
                name: "Essay Structures",
                path: "/pdf/ielts/writing/structures.pdf",
                size: "2.1MB",
                pages: 35,
              },
            ],
          },
          {
            title: "Từ vựng học thuật cho Writing",
            pdfs: [
              {
                name: "Academic Vocabulary List",
                path: "/pdf/ielts/writing/academic_vocab.pdf",
                size: "1.8MB",
                pages: 32,
              },
              {
                name: "Linking Words & Phrases",
                path: "/pdf/ielts/writing/linking_words.pdf",
                size: "0.8MB",
                pages: 12,
              },
            ],
          },
        ],
      },
      {
        name: "Speaking",
        icon: "fas fa-comments",
        materials: [
          {
            title: "50 chủ đề Speaking Part 1-3",
            pdfs: [
              {
                name: "Common Topics Part 1",
                path: "/pdf/ielts/speaking/part1_topics.pdf",
                size: "1.3MB",
                pages: 24,
              },
              {
                name: "Cue Cards Part 2",
                path: "/pdf/ielts/speaking/part2_cards.pdf",
                size: "1.6MB",
                pages: 28,
              },
            ],
          },
          {
            title: "Từ vựng ăn điểm Speaking",
            pdfs: [
              {
                name: "Idioms for Speaking",
                path: "/pdf/ielts/speaking/idioms.pdf",
                size: "0.9MB",
                pages: 16,
              },
              {
                name: "Phrasal Verbs in Speaking",
                path: "/pdf/ielts/speaking/phrasal_verbs.pdf",
                size: "1.1MB",
                pages: 20,
              },
            ],
          },
        ],
      },
    ],
  },
  sat: {
    name: "SAT",
    skills: [
      {
        name: "Math",
        icon: "fas fa-square-root-alt",
        materials: [
          {
            title: "Toàn bộ công thức Toán SAT",
            pdfs: [
              {
                name: "SAT Math Formula Sheet 2023",
                path: "/pdf/sat/math/formulas_2023.pdf",
                size: "1.2MB",
                pages: 12,
              },
              {
                name: "Geometry Cheat Sheet",
                path: "/pdf/sat/math/geometry_cheat.pdf",
                size: "0.9MB",
                pages: 8,
              },
              {
                name: "Advanced Algebra Guide",
                path: "/pdf/sat/math/algebra_guide.pdf",
                size: "2.5MB",
                pages: 36,
              },
            ],
          },
          {
            title: "Bộ đề thi thử Math 2023",
            pdfs: [
              {
                name: "SAT Math Practice Test 1",
                path: "/pdf/sat/math/practice_test1.pdf",
                size: "3.7MB",
                pages: 42,
              },
              {
                name: "May 2023 QAS - Math",
                path: "/pdf/sat/math/may_2023_qas.pdf",
                size: "4.2MB",
                pages: 48,
              },
              {
                name: "Digital SAT Math Samples",
                path: "/pdf/sat/math/digital_samples.pdf",
                size: "2.8MB",
                pages: 35,
              },
            ],
          },
          {
            title: "Bài tập theo chuyên đề",
            pdfs: [
              {
                name: "Heart of Algebra Workbook",
                path: "/pdf/sat/math/algebra_workbook.pdf",
                size: "3.1MB",
                pages: 55,
              },
              {
                name: "Problem Solving Drills",
                path: "/pdf/sat/math/problem_solving.pdf",
                size: "2.4MB",
                pages: 42,
              },
            ],
          },
        ],
      },
      {
        name: "Verbal",
        icon: "fas fa-keyboard",
        materials: [
          {
            title: "500 từ vựng SAT thường gặp",
            pdfs: [
              {
                name: "SAT Vocabulary List 2023",
                path: "/pdf/sat/verbal/vocab_2023.pdf",
                size: "2.1MB",
                pages: 25,
              },
              {
                name: "Root Words Dictionary",
                path: "/pdf/sat/verbal/root_words.pdf",
                size: "1.8MB",
                pages: 32,
              },
            ],
          },
          {
            title: "100 bài SAT Long Reading",
            pdfs: [
              {
                name: "SAT Long Reading 1",
                path: "pdf/Homework/SAT_Long_Reading_1___D4___K69___VĐ.pdf",
                size: "464KB",
                pages: 3,
              },
              {
                name: "SAT Long Reading 2",
                path: "/pdf/Homework/SAT_Long_Reading_2___D4___K69___VĐ.pdf",
                size: "464KB",
                pages: 3,
              },
              {
                name: "SAT Long Reading 3",
                path: "",
                size: "464KB",
                pages: 3,
              },
              {
                name: "SAT Long Reading 4",
                path: "",
                size: "464KB",
                pages: 3,
              },
              {
                name: "SAT Long Reading 5",
                path: "",
                size: "464KB",
                pages: 3,
              },
            ],
          },
        ],
      },
    ],
  },
  ap: {
    name: "AP",
    skills: [
      {
        name: "Calculus",
        icon: "fas fa-infinity",
        materials: [
          {
            title: "Giáo trình AP Calculus BC",
            pdfs: [
              {
                name: "AP Calculus BC Textbook",
                path: "/pdf/ap/calculus/textbook.pdf",
                size: "15.4MB",
                pages: 320,
              },
              {
                name: "Practice Problems with Solutions",
                path: "/pdf/ap/calculus/practice_problems.pdf",
                size: "8.2MB",
                pages: 145,
              },
            ],
          },
          {
            title: "Đề thi các năm trước",
            pdfs: [
              {
                name: "2022 AP Calculus BC Exam",
                path: "/pdf/ap/calculus/2022_exam.pdf",
                size: "6.7MB",
                pages: 95,
              },
              {
                name: "2021 International Practice",
                path: "/pdf/ap/calculus/2021_practice.pdf",
                size: "5.3MB",
                pages: 82,
              },
            ],
          },
        ],
      },
      {
        name: "Physics",
        icon: "fas fa-atom",
        materials: [
          {
            title: "Bộ đề thi AP Physics 1",
            pdfs: [
              {
                name: "Official Practice Exams",
                path: "/pdf/ap/physics/practice_exams.pdf",
                size: "12.5MB",
                pages: 210,
              },
              {
                name: "Formula Sheet",
                path: "/pdf/ap/physics/formula_sheet.pdf",
                size: "1.5MB",
                pages: 18,
              },
            ],
          },
        ],
      },
    ],
  },
  hsk: {
    name: "HSK",
    skills: [
      {
        name: "Nghe",
        icon: "fas fa-headphones",
        materials: [
          {
            title: "File nghe HSK 1-6 chuẩn",
            pdfs: [
              {
                name: "HSK 1-3 Listening Scripts",
                path: "/pdf/hsk/listening/hsk1-3_scripts.pdf",
                size: "2.8MB",
                pages: 52,
              },
              {
                name: "HSK 4-6 Listening Practice",
                path: "/pdf/hsk/listening/hsk4-6_practice.pdf",
                size: "3.5MB",
                pages: 65,
              },
            ],
          },
        ],
      },
      {
        name: "Đọc",
        icon: "fas fa-book-open",
        materials: [
          {
            title: "214 bộ thủ Hán tự",
            pdfs: [
              {
                name: "Complete Radicals List",
                path: "/pdf/hsk/reading/radicals.pdf",
                size: "4.2MB",
                pages: 78,
              },
              {
                name: "Common Character Combinations",
                path: "/pdf/hsk/reading/characters.pdf",
                size: "3.8MB",
                pages: 72,
              },
            ],
          },
        ],
      },
    ],
  },
  german: {
    name: "Tiếng Đức",
    skills: [
      {
        name: "Ngữ pháp",
        icon: "fas fa-language",
        materials: [
          {
            title: "Ngữ pháp tiếng Đức A1-C1",
            pdfs: [
              {
                name: "German Grammar Complete",
                path: "/pdf/german/grammar/complete.pdf",
                size: "9.8MB",
                pages: 185,
              },
              {
                name: "Verb Conjugation Tables",
                path: "/pdf/german/grammar/verbs.pdf",
                size: "3.2MB",
                pages: 55,
              },
            ],
          },
        ],
      },
    ],
  },
  french: {
    name: "Tiếng Pháp",
    skills: [
      {
        name: "Phát âm",
        icon: "fas fa-volume-up",
        materials: [
          {
            title: "Hướng dẫn phát âm chuẩn Paris",
            pdfs: [
              {
                name: "French Pronunciation Guide",
                path: "/pdf/french/pronunciation/guide.pdf",
                size: "5.4MB",
                pages: 92,
              },
              {
                name: "Phonetic Exercises",
                path: "/pdf/french/pronunciation/exercises.pdf",
                size: "2.7MB",
                pages: 48,
              },
            ],
          },
        ],
      },
    ],
  },
  japanese: {
    name: "Tiếng Nhật",
    skills: [
      {
        name: "Kanji",
        icon: "fas fa-kanji",
        materials: [
          {
            title: "214 bộ Kanji cơ bản",
            pdfs: [
              {
                name: "Kanji Nhập Môn",
                path: "/pdf/japanese/kanji/basic.pdf",
                size: "3.5MB",
                pages: 65,
              },
              {
                name: "Kanji JLPT N5",
                path: "/pdf/japanese/kanji/n5.pdf",
                size: "2.8MB",
                pages: 52,
              },
            ],
          },
        ],
      },
      {
        name: "Ngữ pháp",
        icon: "fas fa-language",
        materials: [
          {
            title: "Ngữ pháp JLPT N5-N1",
            pdfs: [
              {
                name: "Ngữ pháp N5",
                path: "/pdf/japanese/grammar/n5.pdf",
                size: "1.9MB",
                pages: 35,
              },
              {
                name: "Mẫu câu giao tiếp",
                path: "/pdf/japanese/grammar/conversation.pdf",
                size: "2.3MB",
                pages: 42,
              },
            ],
          },
        ],
      },
    ],
  },
  korean: {
    name: "Tiếng Hàn",
    skills: [
      {
        name: "Hangul",
        icon: "fas fa-font",
        materials: [
          {
            title: "Bảng chữ cái Hangul",
            pdfs: [
              {
                name: "Học Hangul trong 7 ngày",
                path: "/pdf/korean/hangul/7days.pdf",
                size: "1.5MB",
                pages: 28,
              },
              {
                name: "Luyện viết Hangul",
                path: "/pdf/korean/hangul/writing.pdf",
                size: "2.1MB",
                pages: 38,
              },
            ],
          },
        ],
      },
      {
        name: "Ngữ pháp",
        icon: "fas fa-language",
        materials: [
          {
            title: "Ngữ pháp TOPIK I-II",
            pdfs: [
              {
                name: "Ngữ pháp sơ cấp",
                path: "/pdf/korean/grammar/basic.pdf",
                size: "2.7MB",
                pages: 48,
              },
              {
                name: "Ngữ pháp trung cấp",
                path: "/pdf/korean/grammar/intermediate.pdf",
                size: "3.2MB",
                pages: 55,
              },
            ],
          },
        ],
      },
    ],
  },
};

// ========== CÁC HÀM XỬ LÝ ==========

// Ẩn/hiện tiêu đề chính
function MN2ED_hideMainHeader() {
  document.getElementById("MN2ED_mainTitle").classList.add("hidden");
  document.getElementById("MN2ED_mainSubtitle").classList.add("hidden");
}

function MN2ED_showMainHeader() {
  document.getElementById("MN2ED_mainTitle").classList.remove("hidden");
  document.getElementById("MN2ED_mainSubtitle").classList.remove("hidden");
}

// Hiển thị các kỹ năng khi chọn kỳ thi
function MN2ED_showSkills(examType) {
  const examGrid = document.getElementById("MN2ED_examGrid");
  const skillsContainer = document.getElementById("MN2ED_skillsContainer");
  const backBtn = document.getElementById("MN2ED_backBtn");

  // Ẩn grid kỳ thi và hiển thị nút quay lại
  examGrid.style.display = "none";
  backBtn.style.display = "block";
  MN2ED_hideMainHeader();

  // Xóa nội dung cũ
  skillsContainer.innerHTML = "";
  document.getElementById("MN2ED_materialsContainer").style.display = "none";
  document.getElementById("MN2ED_pdfContainer").style.display = "none";

  // Thêm tiêu đề
  const title = document.createElement("h2");
  title.className = "MN2ED_exam-title";
  title.textContent = `Chọn kỹ năng ${MN2ED_examData[examType].name}`;
  skillsContainer.appendChild(title);

  // Thêm các kỹ năng
  MN2ED_examData[examType].skills.forEach((skill) => {
    const skillCard = document.createElement("div");
    skillCard.className = "MN2ED_skill-card";
    skillCard.onclick = () => MN2ED_showMaterials(examType, skill.name);

    const icon = document.createElement("div");
    icon.className = "MN2ED_skill-icon";
    icon.innerHTML = `<i class="${skill.icon}"></i>`;

    const name = document.createElement("h3");
    name.className = "MN2ED_exam-title";
    name.textContent = skill.name;

    skillCard.appendChild(icon);
    skillCard.appendChild(name);
    skillsContainer.appendChild(skillCard);
  });

  // Hiển thị container kỹ năng
  skillsContainer.style.display = "grid";
}

// Hiển thị tài liệu khi chọn kỹ năng
function MN2ED_showMaterials(examType, skillName) {
  const skillsContainer = document.getElementById("MN2ED_skillsContainer");
  const materialsContainer = document.getElementById(
    "MN2ED_materialsContainer"
  );

  // Ẩn container kỹ năng
  skillsContainer.style.display = "none";

  // Xóa nội dung cũ
  materialsContainer.innerHTML = "";
  document.getElementById("MN2ED_pdfContainer").style.display = "none";

  // Tìm kỹ năng được chọn
  const selectedSkill = MN2ED_examData[examType].skills.find(
    (skill) => skill.name === skillName
  );

  if (selectedSkill) {
    // Thêm tiêu đề
    const title = document.createElement("h2");
    title.className = "MN2ED_exam-title";
    title.textContent = `${MN2ED_examData[examType].name} > ${skillName}`;
    materialsContainer.appendChild(title);

    // Thêm các tài liệu
    selectedSkill.materials.forEach((material) => {
      const materialCard = document.createElement("div");
      materialCard.className = "MN2ED_material-card";
      materialCard.onclick = () =>
        MN2ED_showPdfs(examType, skillName, material.title, material.pdfs);

      const name = document.createElement("h3");
      name.className = "MN2ED_exam-title";
      name.textContent = material.title;

      // Thêm số lượng PDF
      const count = document.createElement("p");
      count.style.color = "#7f8c8d";
      count.textContent = `${material.pdfs.length} tài liệu PDF`;

      materialCard.appendChild(name);
      materialCard.appendChild(count);
      materialsContainer.appendChild(materialCard);
    });
  }

  // Hiển thị container tài liệu
  materialsContainer.style.display = "block";
}

function MN2ED_showPdfs(examType, skillName, materialTitle, pdfs) {
  const materialsContainer = document.getElementById(
    "MN2ED_materialsContainer"
  );
  const pdfContainer = document.getElementById("MN2ED_pdfContainer");

  // Ẩn container materials
  materialsContainer.style.display = "none";

  // Xóa nội dung cũ
  pdfContainer.innerHTML = "";

  // Thêm tiêu đề
  const title = document.createElement("h2");
  title.className = "MN2ED_exam-title";
  title.textContent = `${MN2ED_examData[examType].name} > ${skillName} > ${materialTitle}`;
  pdfContainer.appendChild(title);

  // Thêm các PDF items
  pdfs.forEach((pdf) => {
    const pdfItem = document.createElement("div");
    pdfItem.className = "MN2ED_pdf-item";

    // Thay icon PNG bằng PDF
    const icon = document.createElement("div");
    icon.className = "MN2ED_pdf-icon";
    icon.innerHTML =
      '<img src="img/pdf.png" alt="PDF" style="width: 35px; height: 35px;">';

    const info = document.createElement("div");
    info.className = "MN2ED_pdf-info";

    const pdfTitle = document.createElement("div");
    pdfTitle.className = "MN2ED_pdf-title";
    pdfTitle.textContent = pdf.name;

    const meta = document.createElement("div");
    meta.className = "MN2ED_pdf-meta";
    meta.innerHTML = `
            <span>${pdf.size}</span>
            <span>${pdf.pages} trang</span>
        `;

    const downloadBtn = document.createElement("a");
    downloadBtn.className = "MN2ED_pdf-download";
    downloadBtn.innerHTML = '<i class="fas fa-download"></i> Tải xuống';
    downloadBtn.href = pdf.path;
    downloadBtn.download = pdf.name.replace(/\s+/g, "_") + ".pdf";
    downloadBtn.target = "_blank";

    info.appendChild(pdfTitle);
    info.appendChild(meta);

    pdfItem.appendChild(icon);
    pdfItem.appendChild(info);
    pdfItem.appendChild(downloadBtn);

    pdfContainer.appendChild(pdfItem);
  });

  // Hiển thị container PDF
  pdfContainer.style.display = "block";
}

// Quay lại trang trước
function MN2ED_goBack() {
  const examGrid = document.getElementById("MN2ED_examGrid");
  const skillsContainer = document.getElementById("MN2ED_skillsContainer");
  const materialsContainer = document.getElementById(
    "MN2ED_materialsContainer"
  );
  const pdfContainer = document.getElementById("MN2ED_pdfContainer");
  const backBtn = document.getElementById("MN2ED_backBtn");

  if (pdfContainer.style.display === "block") {
    // Nếu đang ở trang PDF, quay lại trang tài liệu
    pdfContainer.style.display = "none";
    materialsContainer.style.display = "block";
  } else if (materialsContainer.style.display === "block") {
    // Nếu đang ở trang tài liệu, quay lại trang kỹ năng
    materialsContainer.style.display = "none";
    skillsContainer.style.display = "grid";
  } else if (skillsContainer.style.display === "grid") {
    // Nếu đang ở trang kỹ năng, quay lại trang chính
    skillsContainer.style.display = "none";
    examGrid.style.display = "grid";
    backBtn.style.display = "none";
    MN2ED_showMainHeader();
  }
}
